<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="ohmysummer">
    <meta name="description" content="ohmysummer&#39;s personal website">
    <meta name="keywords" content="Perl6,Rakudo">

    <base href="http://ohmysummer.github.io/">
    <title>
  IO 操作 · 焉知非鱼
</title>

    <link rel="canonical" href="http://ohmysummer.github.io/post/2015-10-11-io%E6%93%8D%E4%BD%9C/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.cd087ace86754b082dec94545567f8361cba42e84f8e15edbc4a9f6e52bd1f6a.css" integrity="sha256-zQh6zoZ1Swgt7JRUVWf4Nhy6QuhPjhXtvEqfblK9H2o=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://ohmysummer.github.io/css/style.css">
    

    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ohmysummer.github.io/">
      焉知非鱼
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/post">博客</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/categories">归档</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/page/about/">关于</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags">标签</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>IO 操作</h1>
    </header>

    

<p>文件存在、文件的时间戳、文件的修改时间等等</p>

<h3 id="批量插入文本">批量插入文本</h3>

<pre><code class="language-perl6">use v6;

my @filenames = dir '.',  test =&gt; any(/\.md$/, /\.markdown/);

for @filenames -&gt; $filePath {
    my $path = $filePath.path();
    $path ~~ s/.md//;
    $path ~~ s/.markdown//;

    my $date = DateTime.new(now);
    my $head =
qq:heredoc 'EOT';
title:  $path.IO.basename()
date: $date
tags: Perl6
categories: Perl 6

---

&lt;blockquote class=&quot;blockquote-center&quot;&gt;这城市有太多风景都在提醒那过去！&lt;/blockquote&gt;

[TOC]

EOT

   my @content   = slurp $filePath;
   spurt($filePath.path, &quot;$head\n@content[]&quot;);
}

</code></pre>

<p>在当前目录中查找所有以 <code>.md</code> (.markdown)结尾的文件（即markdown文件）, 并在文件最前面插入一段文本， 形如：</p>

<pre><code class="language-perl6">title:  Perl6
date: 2015-08-20T23:19:13Z
tags: Perl6
categories: Perl 6

---

&lt;blockquote class=&quot;blockquote-center&quot;&gt;我站在天桥上念你, 有点狼狈&lt;/blockquote&gt;

</code></pre>

<p>类 <code>IO::Path</code> 提供了 <code>basename</code>, <code>path</code>, <code>parts</code>, 等方法供使用, 具体用法请看文档:</p>

<pre><code class="language-perl6">p6doc IO::Path
</code></pre>

<p>一些例子：</p>

<pre><code class="language-perl6">say IO::Path.new(&quot;/etc/passwd&quot;).basename;   # passwd
say IO::Path.new(&quot;docs/README.pod&quot;).extension;   # pod
say IO::Path.new(&quot;/etc/passwd&quot;).dirname;    # /etc
say IO::Path::Win32.new(&quot;C:\\Windows\\registry.ini&quot;).volume;    # C:
say IO::Path.new(&quot;/etc/passwd&quot;).parts.perl # (&quot;dirname&quot; =&gt; &quot;/etc&quot;, &quot;volume&quot;  =&gt; &quot;&quot;, &quot;basename&quot; =&gt; &quot;passwd&quot;).hash
</code></pre>

<p>Examples:</p>

<pre><code class="language-perl6">

    # To iterate over the contents of the current directory: for dir() -&gt; $file
    {
        say $file;
    }

    # As before, but include even '.' and '..' which are filtered out by # the
    default :test matcher: for dir(test =&gt; *) -&gt; $file {
        say $file;
    }

    # To get the names of all .jpg and .jpeg files in ~/Downloads: my @jpegs =
    &quot;%*ENV&lt;HOME&gt;/Downloads&quot;.IO.dir(test =&gt; /:i '.' jpe?g $/)».Str;


# An example program that lists all files and directories recursively:

    sub MAIN($dir = '.') {
        my @todo = $dir.IO; while @todo {
            for @todo.pop.dir -&gt; $path {
                say $path.Str; @todo.push: $path if $path.d;
            }
        }
    }
</code></pre>

<h3 id="文件测试操作符">文件测试操作符</h3>

<hr />

<pre><code class="language-perl6"># If you have a string - a path to something in the filesystem:

    if &quot;path/to/file&quot;.IO ~~ :e {
        say 'file exists';
    }

    my $file = &quot;path/to/file&quot;; if $file.IO ~~ :e {
        say 'file exists';
    }

# Instead of the colonpair syntax, you can use method calls too:

    if 'path/to/file'.IO.e {
        say 'file exists';
    }

# If you already have an IO object in $file, either by creating one yourself, or
# by getting it from another subroutine, such as dir, you can write this:

    my $file = &quot;path/to/file&quot;.IO; if $file ~~ :e {
        say 'file exists';
    }
</code></pre>

<h3 id="文件时间戳">文件时间戳：</h3>

<hr />

<pre><code class="language-perl6">say &quot;path/to/file&quot;.IO.modified;                # e.g. Instant:1424089165
say DateTime.new(&quot;path/to/file&quot;.IO.modified);  # e.g. 2015-02-16T12:18:50Z

my $modification_instant = &quot;path/to/file&quot;.IO.modified;
my $modification_time    = DateTime.new($modification_instant);
say $modification_time;  # e.g. 2015-02-16T12:18:50Z


say &quot;path/to/file&quot;.IO.accessed;                # e.g. Instant:1424353577
say DateTime.new(&quot;path/to/file&quot;.IO.accessed);  # e.g. 2015-02-19T13:45:42Z

my $access_instant = &quot;path/to/file&quot;.IO.accessed;
my $access_time    =  DateTime.new($access_instant);
say $access_time;  # e.g. 2015-02-19T13:45:42Z


say &quot;path/to/file&quot;.IO.changed;                # e.g. Instant:1424089165
say DateTime.new(&quot;path/to/file&quot;.IO.changed);  # e.g. 2015-02-16T12:18:50Z

my $change_instant = &quot;path/to/file&quot;.IO.changed;
my $change_time    =  DateTime.new($chnge_instant);
say $change_time;  # e.g. 2015-02-16T12:18:50Z
</code></pre>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>ohmysummer ❤ Perl 6</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
