<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>ç¬¬äºŒåäºŒå¤©-Perl 6.d çš„ç‰¹æ€§</title>
  <meta property="og:title" content="ç¬¬äºŒåäºŒå¤©-Perl 6.d çš„ç‰¹æ€§" />
  <meta name="twitter:title" content="ç¬¬äºŒåäºŒå¤©-Perl 6.d çš„ç‰¹æ€§" />
  <meta name="description" content="Day 22 â€“ Features of Perl 6.d">
  <meta property="og:description" content="Day 22 â€“ Features of Perl 6.d">
  <meta name="twitter:description" content="Day 22 â€“ Features of Perl 6.d">
  <meta name="author" content="ç„‰çŸ¥éé±¼"/>
  <link href='https://ohmysummer.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://ohmysummer.github.io/img/avatar-icon.jpg" />
  <meta name="twitter:image" content="https://ohmysummer.github.io/img/avatar-icon.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://ohmysummer.github.io/post/2017-12-22-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E5%A4%A9-perl-6.d%E7%9A%84%E7%89%B9%E6%80%A7/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Young For Perl 6" />

  <meta name="generator" content="Hugo 0.41" />
  <link rel="canonical" href="https://ohmysummer.github.io/post/2017-12-22-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E5%A4%A9-perl-6.d%E7%9A%84%E7%89%B9%E6%80%A7/" />
  <link rel="alternate" href="https://ohmysummer.github.io/index.xml" type="application/rss+xml" title="Young For Perl 6">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://ohmysummer.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://ohmysummer.github.io/css/syntax.css" /><link rel="stylesheet" href="https://ohmysummer.github.io/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://ohmysummer.github.io/">Young For Perl 6</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="åšå®¢" href="/">åšå®¢</a>
            </li>
          
        
          
            <li>
              <a title="å½’æ¡£" href="/categories">å½’æ¡£</a>
            </li>
          
        
          
            <li>
              <a title="å…³äº" href="/page/about/">å…³äº</a>
            </li>
          
        
          
            <li>
              <a title="æ ‡ç­¾" href="/tags">æ ‡ç­¾</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Young For Perl 6" href="https://ohmysummer.github.io/">
            <img class="avatar-img" src="https://ohmysummer.github.io/img/avatar-icon.jpg" alt="Young For Perl 6" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>ç¬¬äºŒåäºŒå¤©-Perl 6.d çš„ç‰¹æ€§</h1>
                
                  
                    <h2 class="post-subheading">Day 22 â€“ Features of Perl 6.d</h2>
                  
                
                
                  <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;2017/22/24
  
  
  
</span>

                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<h1 id="day-22-features-of-perl-6-d-https-perl6advent-wordpress-com-2017-12-22-day-22-features-of-perl-6-d"><a href="https://perl6advent.wordpress.com/2017/12/22/day-22-features-of-perl-6-d/">Day 22 â€“ Features of Perl 6.d</a></h1>

<p>æ‰€ä»¥æˆ‘ä»¬å°±æ˜¯è¿™æ ·ã€‚ Rakudo Perl 6ç¬¬ä¸€æ¬¡æ­£å¼å‘å¸ƒä¸¤å¹´åï¼Œæˆ–è€…æ›´å‡†ç¡®çš„è¯´æ˜¯6.cã€‚è‡ªä»é©¬ç‰¹å¥¥èŒ¨ä»é‚£æ—¶èµ·å°±å¼€å§‹å…³æ³¨æ€§èƒ½çš„æå‡ä¹‹åï¼Œåœ£è¯è€äººè®¤ä¸ºè¦å¯¹æ­¤è¿›è¡Œå¯¹æ¯”ï¼Œæè¿°è‡ªé‚£æ—¶èµ·å®æ–½çš„6.dçš„æ–°åŠŸèƒ½ã€‚å› ä¸ºæœ‰å¾ˆå¤šï¼Œåœ£è¯è€äººä¸å¾—ä¸åšå‡ºé€‰æ‹©ã€‚</p>

<h2 id="åœ¨åˆ›å»ºæ—¶è°ƒæ•´å¯¹è±¡">åœ¨åˆ›å»ºæ—¶è°ƒæ•´å¯¹è±¡</h2>

<p>æ‚¨åˆ›å»ºçš„ä»»ä½•è¯¾ç¨‹ç°åœ¨éƒ½å¯ä»¥ä½¿ç”¨TWEAKæ–¹æ³•ã€‚åœ¨æ–°çš„ç±»çš„æ–°å®ä¾‹çš„æ‰€æœ‰å…¶ä»–åˆå§‹åŒ–å®Œæˆä¹‹å‰ï¼Œè¿™ä¸ªæ–¹æ³•å°†è¢«è°ƒç”¨ã€‚ä¸€ä¸ªç®€å•çš„ï¼Œæœ‰ç‚¹äººä¸ºçš„ä¾‹å­ï¼Œå…¶ä¸­ä¸€ä¸ªç±»Aæœ‰ä¸€ä¸ªå±æ€§ï¼Œé»˜è®¤å€¼æ˜¯42ï¼Œä½†å¦‚æœåœ¨åˆ›å»ºå¯¹è±¡æ—¶æŒ‡å®šäº†é»˜è®¤å€¼ï¼Œå®ƒåº”è¯¥æ›´æ”¹è¯¥å€¼ï¼š</p>

<pre><code class="language-perl6">class A {
    has $.value = 42;
    method TWEAK(:$value = 0) { # default prevents warning
        # change the attribute if the default value is specified
        $!value = 666 if $value == $!value;
    }
}
# no value specified, it gets the default attribute value
dd A.new;              # A.new(value =&gt; 42)

# value specified, but it is not the default
dd A.new(value =&gt; 77); # A.new(value =&gt; 77)

# value specified, and it is the default 
dd A.new(value =&gt; 42); # A.new(value =&gt; 666)
</code></pre>

<h2 id="å¹¶å‘æ€§æ”¹è¿›">å¹¶å‘æ€§æ”¹è¿›</h2>

<p>Rakudo Perl 6çš„å¹¶å‘åŠŸèƒ½åœ¨å¼•æ“ç›–ä¸‹çœ‹åˆ°äº†è®¸å¤šæ”¹è¿›ã€‚å…¶ä¸­ä¸€äº›æš´éœ²ä¸ºæ–°åŠŸèƒ½ã€‚æœ€æ˜¾ç€çš„æ˜¯Lock :: Asyncï¼ˆä¸€ä¸ªè¿”å›Promiseçš„éé˜»å¡é”ï¼‰å’ŒåŸå­æ“ä½œç¬¦ã€‚</p>

<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¸éœ€è¦ç›´æ¥ä½¿ç”¨å®ƒä»¬ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ­£åœ¨ç¼–å†™ä½¿ç”¨å¹¶å‘åŠŸèƒ½çš„ç¨‹åºï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½çŸ¥é“åŸå­æ“ä½œç¬¦ã€‚ç»å¸¸å‘ç”Ÿçš„é€»è¾‘é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ åœ¨Pumpking Perl 5ä¸­ä½¿ç”¨çº¿ç¨‹ï¼Œæ˜¯å› ä¸ºåœ¨Rakudo Perl 6ä¸­æ²¡æœ‰å¯¹å…±äº«å˜é‡çš„éšå¼é”å®šã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">my int $a;
    await (^5).map: {
        start { ++$a for ^100000 }
    }
    say $a; # something like 419318
</code></pre>

<p>é‚£ä¹ˆä¸ºä»€ä¹ˆæ²¡æœ‰æ˜¾ç¤º500000ï¼ŸåŸå› æ˜¯æˆ‘ä»¬æœ‰5ä¸ªçº¿ç¨‹åŒæ—¶é€’å¢ç›¸åŒçš„å˜é‡ã€‚ç”±äºå¢é‡ç”±è¯»æ­¥éª¤ï¼Œå¢é‡æ­¥éª¤å’Œå†™æ­¥éª¤ç»„æˆï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹ä¸å¦ä¸€ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œè¯»å–æ­¥éª¤å˜å¾—éå¸¸å®¹æ˜“ã€‚å› æ­¤å¤±å»äº†ä¸€ä¸ªå¢é‡ã€‚åœ¨æˆ‘ä»¬æœ‰åŸå­æ“ä½œç¬¦ä¹‹å‰ï¼Œåšä¸Šè¿°ä»£ç çš„æ­£ç¡®æ–¹æ³•æ˜¯ï¼š</p>

<pre><code class="language-perl6">   my int $a;
    my $l = Lock.new;
    await (^5).map: {
       start {
           for ^100000 {
               $l.protect( { ++$a } )
           }
       }
    }
    say $a; # 500000
</code></pre>

<p>è¿™ä¼šç»™ä½ æ­£ç¡®çš„ç­”æ¡ˆï¼Œä½†é€Ÿåº¦è‡³å°‘è¦æ…¢20å€ã€‚</p>

<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†åŸå­å˜é‡ï¼Œä¸Šé¢çš„ä»£ç å°±å˜æˆäº†ï¼š</p>

<pre><code class="language-perl6">   my atomicint $a;
    await (^5).map: {
        start { ++âš›$a for ^100000 }
    }
    say $a; # 500000
</code></pre>

<p>è¿™éå¸¸ç±»ä¼¼äºåŸå§‹ï¼ˆä¸æ­£ç¡®ï¼‰çš„ä»£ç ã€‚è¿™è‡³å°‘æ˜¯ä½¿ç”¨Lock.protectçš„æ­£ç¡®ä»£ç çš„6å€ã€‚</p>

<h2 id="unicode-goodies">Unicode goodies</h2>

<p>å¤ªå¤šäº†ï¼Œå¤ªå¤šäº†ã€‚ä¾‹å¦‚ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨â‰¤ï¼Œâ‰¥ï¼Œâ‰ ä½œä¸ºUnicodeç‰ˆæœ¬çš„&lt;=ï¼Œ&gt; =å’Œï¼=ï¼ˆå®Œæ•´åˆ—è¡¨ï¼‰ã€‚</p>

<p>æ‚¨ç°åœ¨è¿˜å¯ä»¥é€šè¿‡æŒ‡å®šå­—å½¢çš„Unicodeåç§°æ¥åˆ›å»ºå­—å½¢ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">say &quot;BUTTERFLY&quot;.parse-names; # ğŸ¦‹
</code></pre>

<p>æˆ–è€…åœ¨è¿è¡Œæ—¶åˆ›å»ºUnicodeåç§°å­—ç¬¦ä¸²ï¼š</p>

<pre><code class="language-perl6">my $t = &quot;THUMBS UP SIGN, EMOJI MODIFIER FITZPATRICK TYPE&quot;;
print &quot;$t-$_&quot;.parse-names for 3..6; # ğŸ‘ğŸ¼ğŸ‘ğŸ½ğŸ‘ğŸ¾ğŸ‘ğŸ¿
</code></pre>

<p>æˆ–è€…æ•´ç†è€Œä¸æ˜¯ä»…ä»…æ’åºï¼š</p>

<pre><code class="language-perl6"># sort by codepoint value
say &lt;Ã¤ a o Ã¶&gt;.sort; # (a o Ã¤ Ã¶)
# sort using Unicode Collation Algorithm
say &lt;Ã¤ a o Ã¶&gt;.collate; # (a Ã¤ o Ã¶)
</code></pre>

<p>æˆ–è€…ä½¿ç”¨unicmpè€Œä¸æ˜¯cmpï¼š</p>

<pre><code class="language-perl6">say &quot;a&quot; cmp &quot;Z&quot;; # More
say &quot;a&quot; unicmp &quot;Z&quot;; # Less
</code></pre>

<p>æˆ–è€…æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä»»ä½•Unicodeæ•°å­—åŒ¹é…å˜é‡ï¼ˆ$ 1ä¸º$ 1ï¼‰ï¼Œè´Ÿæ•°ï¼ˆ-1ä¸º-1ï¼‰å’ŒåŸºæ•°åŸºæ•°ï¼ˆï¼š3ï¼ˆâ€œ22â€ï¼‰ä¸º3ï¼ˆâ€œ22â€ï¼‰ï¼‰ã€‚</p>

<p>åœ£è¯è€äººè®¤ä¸ºRakudo Perl 6æ‹¥æœ‰ä¸–ç•Œä¸Šä»»ä½•ç¼–ç¨‹è¯­è¨€çš„æœ€ä½³Unicodeæ”¯æŒï¼</p>

<h2 id="è·³è¿‡å€¼">è·³è¿‡å€¼</h2>

<p>æ‚¨ç°åœ¨å¯ä»¥åœ¨Seqå’ŒSupplyä¸Šè°ƒç”¨.skipè·³è¿‡æ­£åœ¨ç”Ÿæˆçš„å¤šä¸ªå€¼ã€‚ä¸.headå’Œ.tailä¸€èµ·ï¼Œè¿™ç»™äº†ä½ Iterableså’ŒSupplieså……è¶³çš„æ“ä½œæ€§ã€‚</p>

<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œ.headç°åœ¨ä¹Ÿä¼šå¸¦ä¸€ä¸ªWhateverCodeï¼Œæ‰€ä»¥ä½ å¯ä»¥æŒ‡æ˜é™¤äº†æœ€åNä»¥å¤–çš„æ‰€æœ‰å€¼ï¼ˆä¾‹å¦‚.headï¼ˆ*  -  3ï¼‰ä¼šç»™ä½ é™¤äº†æœ€åä¸‰ä¸ªä»¥å¤–çš„æ‰€æœ‰å€¼ï¼‰ã€‚ .tailä¹Ÿæ˜¯å¦‚æ­¤ï¼ˆä¾‹å¦‚.tailï¼ˆ*  -  3ï¼‰ä¼šä¸ºæ‚¨æä¾›é™¤å‰ä¸‰ä¸ªä¹‹å¤–çš„æ‰€æœ‰å€¼ï¼‰ã€‚</p>

<p>å¯¹è¿­ä»£å™¨è§’è‰²çš„ä¸€äº›è¡¥å……ä½¿å¾—è¿­ä»£å™¨å¯ä»¥æ›´å¥½åœ°æ”¯æŒ.skipåŠŸèƒ½ã€‚å¦‚æœä¸€ä¸ªè¿­ä»£å™¨å¯ä»¥æ›´æœ‰æ•ˆåœ°è·³è¿‡ä¸€ä¸ªå€¼è€Œä¸æ˜¯å®é™…äº§ç”Ÿå®ƒï¼Œå®ƒåº”è¯¥å®ç°skip-oneæ–¹æ³•ã€‚æ´¾ç”Ÿäºæ­¤çš„æ˜¯å¯ä»¥ç”±è¿­ä»£å™¨æä¾›çš„è·³è¿‡è‡³å°‘å’Œè·³è¿‡è‡³å°‘æ‹‰ä¸€ä¸ªæ–¹æ³•ã€‚</p>

<p>ä½¿ç”¨.skipæŸ¥æ‰¾ç¬¬1000ä¸ªç´ æ•°çš„ç¤ºä¾‹ï¼š</p>

<pre><code class="language-perl6">say (^Inf).grep(*.is-prime)[999]; # 7919
</code></pre>

<p>ä¸</p>

<pre><code class="language-perl6">say (^Inf).grep(*.is-prime).skip(999).head; # 7919
</code></pre>

<p>åè€…çš„CPUæ•ˆç‡ç•¥é«˜ä¸€äº›ï¼Œä½†æ›´é‡è¦çš„æ˜¯å†…å­˜æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä¿ç•™å†…å­˜ä¸­çš„å‰999ä¸ªç´ æ•°ã€‚</p>

<h2 id="of-bufs-and-blobs">Of Bufs and Blobs</h2>

<p>Bufå˜å¾—æ›´åƒä¸€ä¸ªArrayï¼Œå› ä¸ºå®ƒç°åœ¨æ”¯æŒ.pushï¼Œ.appendï¼Œ.popï¼Œ.unshiftï¼Œ.prependï¼Œ.shiftå’Œ.spliceã€‚å®ƒä¹Ÿå˜å¾—æ›´åƒStrï¼Œå¢åŠ äº†ä¸€ä¸ªsubbuf-rwï¼ˆç±»ä¼¼äº.substr-rwï¼‰ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">my $b = Buf.new(100..105);
$b.subbuf-rw(2,3) = Blob.new(^5);
say $b.perl; # Buf.new(100,101,0,1,2,3,4,105)
</code></pre>

<p>æ‚¨ç°åœ¨ä¹Ÿå¯ä»¥ä½¿ç”¨ç»™å®šæ•°é‡çš„å…ƒç´ å’Œæ¨¡å¼æ¥åˆ†é…Bufæˆ–Blobã€‚æˆ–è€…ç”¨.reallocateæ”¹å˜Bufçš„å¤§å°ï¼š</p>

<pre><code class="language-perl6">my $b = Buf.allocate(10,(1,2,3));
say $b.perl; # Buf.new(1,2,3,1,2,3,1,2,3,1)
$b.reallocate(5);
say $b.perl; # Buf.new(1,2,3,1,2)
</code></pre>

<h2 id="æµ‹è¯•-æµ‹è¯•-æµ‹è¯•">æµ‹è¯•ï¼Œæµ‹è¯•ï¼Œæµ‹è¯•ï¼</h2>

<p>Test.pmçš„è®¡åˆ’å­ä¾‹ç¨‹ç°åœ¨è¿˜é‡‡ç”¨å¯é€‰çš„ï¼šskip-allå‚æ•°æ¥æŒ‡ç¤ºæ–‡ä»¶ä¸­çš„æ‰€æœ‰æµ‹è¯•éƒ½åº”è¯¥è·³è¿‡ã€‚æˆ–è€…æ‚¨å¯ä»¥æ‹¨æ‰“æ•‘åŠ©ä¸­æ­¢æµ‹è¯•è¿è¡Œï¼Œå°†å…¶æ ‡è®°ä¸ºå¤±è´¥ã€‚æˆ–è€…å°†PERL6_TEST_DIE_ON_FAILç¯å¢ƒå˜é‡è®¾ç½®ä¸ºçœŸå€¼ï¼Œä»¥æŒ‡ç¤ºæ‚¨å¸Œæœ›æµ‹è¯•ä¸€æ—¦ç¬¬ä¸€æ¬¡æµ‹è¯•å¤±è´¥å°±ç«‹å³ç»“æŸã€‚</p>

<h2 id="è¿™æ˜¯æ€ä¹ˆå›äº‹">è¿™æ˜¯æ€ä¹ˆå›äº‹</h2>

<p>æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡è°ƒç”¨Kernel.cpu-coresæ¥åæ€è®¡ç®—æœºä¸­CPUå†…æ ¸çš„æ•°é‡ã€‚ç¨‹åºå¯åŠ¨åä½¿ç”¨çš„CPUæ•°é‡åœ¨Kernel.cpu-usageä¸­å¯ç”¨ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨VM.osnameè½»æ¾æ£€æŸ¥æ“ä½œç³»ç»Ÿçš„åç§°ã€‚</p>

<p>å°±å¥½åƒè¿™è¿˜ä¸å¤Ÿï¼Œè¿˜æœ‰ä¸€ä¸ªæ–°çš„é¥æµ‹æ¨¡å—ï¼Œæ‚¨éœ€è¦åœ¨éœ€è¦æ—¶åŠ è½½ï¼Œå°±åƒæµ‹è¯•æ¨¡å—ä¸€æ ·ã€‚é¥æµ‹æ¨¡å—æä¾›äº†è®¸å¤šå¯ç›´æ¥ä½¿ç”¨çš„åŸºå…ƒï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">use Telemetry;
say T&lt;wallclock cpu max-rss&gt;; # (138771 280670 82360)
</code></pre>

<p>å®ƒæ˜¾ç¤ºè‡ªç¨‹åºå¯åŠ¨ä»¥æ¥çš„å¾®ç§’æ•°ï¼Œæ‰€ç”¨CPUçš„å¾®ç§’æ•°ä»¥åŠè°ƒç”¨æ—¶æ­£åœ¨ä½¿ç”¨çš„å†…å­˜æ•°é‡ã€‚</p>

<p>å¦‚æœä½ æƒ³å¾—åˆ°ä½ çš„ç¨‹åºä¸­å‘ç”Ÿçš„äº‹æƒ…çš„æŠ¥å‘Šï¼Œä½ å¯ä»¥ä½¿ç”¨ç®¡ç†å•å…ƒï¼Œå¹¶åœ¨ç¨‹åºå®Œæˆæ—¶æ˜¾ç¤ºæŠ¥å‘Šã€‚ä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">use Telemetry;
snap;
Nil for ^10000000;  # something that takes a bit of time
</code></pre>

<p>ç»“æœå°†æ˜¾ç¤ºåœ¨STDERRä¸Šï¼š</p>

<pre><code>Telemetry Report of Process #60076
Number of Snapshots: 2
Initial/Final Size: 82596 / 83832 Kbytes
Total Time:           0.55 seconds
Total CPU Usage:      0.56 seconds
No supervisor thread has been running

wallclock  util%  max-rss
   549639  12.72     1236
--------- ------ --------
   549639  12.72     1236

Legend:
wallclock  Number of microseconds elapsed
    util%  Percentage of CPU utilization (0..100%)
  max-rss  Maximum resident set size (in Kbytes)
</code></pre>

<p>å¦‚æœä½ æƒ³è¦æ¯ç§’1æ¬¡çš„ç¨‹åºçŠ¶æ€ï¼Œä½ å¯ä»¥ä½¿ç”¨snapperï¼š</p>

<pre><code class="language-perl6">use Telemetry;
snapper;
Nil for ^10000000;  # something that takes a bit of time
</code></pre>

<p>ç»“æœï¼š</p>

<pre><code>Telemetry Report of Process #60722
Number of Snapshots: 7
Initial/Final Size: 87324 / 87484 Kbytes
Total Time:           0.56 seconds
Total CPU Usage:      0.57 seconds
No supervisor thread has been running

wallclock  util%  max-rss
   103969  13.21      152
   101175  12.48
   101155  12.48
   104097  12.51
   105242  12.51
    44225  12.51        8
--------- ------ --------
   559863  12.63      160

Legend:
wallclock  Number of microseconds elapsed
    util%  Percentage of CPU utilization (0..100%)
  max-rss  Maximum resident set size (in Kbytes)
</code></pre>

<p>è¿˜æœ‰æ›´å¤šé€‰é¡¹å¯ç”¨ï¼Œä¾‹å¦‚ä»¥.csvæ ¼å¼è·å–è¾“å‡ºã€‚</p>

<h2 id="main-å‡½æ•°">MAIN å‡½æ•°</h2>

<p>æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡è®¾ç½®ï¼…* SUB-MAIN-OPTSä¸­çš„é€‰é¡¹æ¥ä¿®æ”¹MAINå‚æ•°çš„å¤„ç†æ–¹å¼ã€‚é»˜è®¤çš„USAGEæ¶ˆæ¯ç°åœ¨å¯ä»¥åœ¨MAINä¸­ä½œä¸º$ * USAGEåŠ¨æ€å˜é‡ä½¿ç”¨ï¼Œæ‰€ä»¥å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æ”¹å˜å®ƒã€‚</p>

<h2 id="åµŒå…¥-perl-6">åµŒå…¥ Perl 6</h2>

<p>ä¸¤ä¸ªæ–°åŠŸèƒ½ä½¿åµŒå…¥Rakudo Perl 6æ›´æ˜“äºå¤„ç†ï¼š
ç°åœ¨å¯ä»¥è®¾ç½®ï¼†* EXITåŠ¨æ€å˜é‡æ¥æŒ‡å®šè°ƒç”¨exitï¼ˆï¼‰æ—¶è¦æ‰§è¡Œçš„æ“ä½œã€‚</p>

<p>å°†ç¯å¢ƒå˜é‡RAKUDO_EXCEPTIONS_HANDLERè®¾ç½®ä¸ºâ€œJSONâ€å°†å¼•å‘JSONä¸­çš„å¼‚å¸¸ï¼Œè€Œä¸æ˜¯æ–‡æœ¬ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code class="language-perl6">$ RAKUDO_EXCEPTIONS_HANDLER=JSON perl6 -e '42 = 666'
{
  &quot;X::Assignment::RO&quot; : {
    &quot;value&quot; : 42,
    &quot;message&quot; : &quot;Cannot modify an immutable Int (42)&quot;
  }
}
</code></pre>

<h2 id="ç¤¼å“è¢‹çš„åº•éƒ¨">ç¤¼å“è¢‹çš„åº•éƒ¨</h2>

<p>åœ¨ç¿»çœ‹ä»ç„¶ç›¸å½“å®Œæ•´çš„ç¤¼å“è¢‹çš„åŒæ—¶ï¼Œåœ£è¯è€äººå‘ç°äº†ä»¥ä¸‹è¾ƒå°çš„æƒŠæ‚šç‰‡ï¼š</p>

<p>æœ¬åœ°å­—ç¬¦ä¸²æ•°ç»„ç°åœ¨å®ç°ï¼ˆæˆ‘çš„str @aï¼‰
IO :: CatHandleå…è®¸æ‚¨å°†å¤šä¸ªæ•°æ®æºæŠ½è±¡ä¸ºå•ä¸ªè™šæ‹ŸIO :: Handle
parse-baseï¼ˆï¼‰æ‰§è¡Œbaseï¼ˆï¼‰çš„ç›¸åæ“ä½œ</p>

<h2 id="èµ¶ä¸Šé›ªæ©‡çš„æ—¶é—´">èµ¶ä¸Šé›ªæ©‡çš„æ—¶é—´</h2>

<p>åœ£è¯è€äººæƒ³ç•™ä¸‹æ¥å‘Šè¯‰ä½ æ›´å¤šæœ‰å…³å·²æ·»åŠ çš„å†…å®¹ï¼Œä½†æ˜¯æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å¦‚æœæ‚¨çœŸçš„æƒ³äº†è§£æ–°åŠŸèƒ½çš„æœ€æ–°æƒ…å†µï¼Œæ‚¨åº”è¯¥æŸ¥çœ‹Changelogä¸­çš„Additionséƒ¨åˆ†ï¼Œè¿™äº›éƒ¨åˆ†éšæ¯ä¸ªRakudoç¼–è¯‘å™¨ç‰ˆæœ¬ä¸€èµ·æ›´æ–°ã€‚</p>

<p>æ‰€ä»¥ï¼Œæ˜å¹´å†æ¥æŠ“ä½ ï¼</p>

<p>æ¥è‡ªç¾å¥½çš„ç¥ç¦</p>

<p>ğŸ…ğŸ¾</p>


        
          <div class="blog-tags">
            
              <a href="https://ohmysummer.github.io//tags/perl-6/">Perl 6</a>&nbsp;
            
          </div>
        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://ohmysummer.github.io/post/2017-12-21-perl-6-%E4%B8%AD%E7%9A%84-proto-%E5%85%B3%E9%94%AE%E5%AD%97/" data-toggle="tooltip" data-placement="top" title="Perl 6 ä¸­çš„ proto å…³é”®å­—">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://ohmysummer.github.io/post/2017-12-22-exploring-the-bool-type-in-perl-6-part-1/" data-toggle="tooltip" data-placement="top" title="Exploring the Bool type in Perl 6, part 1">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "ohmysummer" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            
            <a href="https://ohmysummer.github.io/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://ohmysummer.github.io/">ç„‰çŸ¥éé±¼</a>
            
          

          <span style="color: red;">â¤</span>&nbsp;Perl 6
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.41</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://ohmysummer.github.io/js/main.js"></script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="https://ohmysummer.github.io/js/load-photoswipe.js"></script>






  </body>
</html>

