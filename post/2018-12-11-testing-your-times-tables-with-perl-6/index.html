<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="ohmysummer">
    <meta name="description" content="ohmysummer&#39;s personal website">
    <meta name="keywords" content="Perl6,Rakudo">

    <base href="http://ohmysummer.github.io/">
    <title>
  第十一天 - 使用 Perl 6 测试你的时刻表 · 焉知非鱼
</title>

    <link rel="canonical" href="http://ohmysummer.github.io/post/2018-12-11-testing-your-times-tables-with-perl-6/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.cd087ace86754b082dec94545567f8361cba42e84f8e15edbc4a9f6e52bd1f6a.css" integrity="sha256-zQh6zoZ1Swgt7JRUVWf4Nhy6QuhPjhXtvEqfblK9H2o=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://ohmysummer.github.io/css/style.css">
    

    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ohmysummer.github.io/">
      焉知非鱼
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/post">博客</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/categories">归档</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/page/about/">关于</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags">标签</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>第十一天 - 使用 Perl 6 测试你的时刻表</h1>
    </header>

    <p>这几乎是在北极附近的精灵小学冬季学期结束之时。对于精灵而言，敏锐的人物头脑非常重要，而小精灵的数学老师 Hopper 女士希望确保他们在任期的倒数第二天保持他们的算术技能。（学期的最后一天保留用于观看电影和玩耍 -  很嗨皮）。</p>

<p>小精灵刚刚学会了他们的时间表（乘法表），最多12个，但他们并不像他们所想的那样擅长，其中一些人在圣诞节前将在玩具工作坊帮忙，那时候他们可能需要快速告诉大精灵有多少特定类型的玩具。</p>

<p>幸运的是，Elf Hopper 是一个非常聪明的精灵，拥有出色的数学和编码能力 - 自己。所以她起了一个快速的控制台应用程序来运行小精灵的学校颁发的 Perlix 6.0 boxen。</p>

<p>该程序允许小精灵通过运行它们在2至12次表中测试自己，或者如果它们提供单个数字参数，他们可以尝试任何他们喜欢的乘法表。</p>

<pre><code class="language-perl6">#!/usr/bin/env perl6

use v6;

my $fixednum;
my %score;
my @exits = &lt;exit quit&gt;;

$fixednum = @*ARGS[0] || 0;
put &quot;Type the answer, or quit or exit to end the test.&quot;;


loop {
    my $coefficient = (2..12).pick;
    my $number = $fixednum || (2..12).pick;

    my $answer = prompt ( &quot;$coefficient × $number = &quot; );
    my $rightanswer = $coefficient × $number;

    last if $answer.lc ~~ any @exits;

    if $answer == $rightanswer {
        put &quot;Correct!&quot;;
        %score&lt;correct&gt;++;
    } else {
        put &quot;Sorry, that wasn't right! The answer is $rightanswer&quot;;
    }
    %score&lt;total&gt;++;
}

if %score&lt;total&gt;:exists {
    my $pc = 100 * %score&lt;correct&gt; / %score&lt;total&gt;;
    put &quot;You scored %score&lt;correct&gt; out of %score&lt;total&gt;, i.e. &quot;, sprintf &quot;%2.2f%%.&quot;, $pc;
}
</code></pre>

<p>Elf Hopper 向其它小精灵解释代码如下。</p>

<p>“可爱的小精灵们！这是关于程序如何工作的一些背景知识。</p>

<p>我在顶部附近添加了 <code>use v6;</code>，以便代码也可以在 Perl 5下 运行，它将自动使用 Perl 6 仿真器。</p>

<p>您将看到程序在特殊的 <code>@*ARGS</code> 数组的命令行上运行时选择一个可选参数。这是 Perl 5 的 <code>@ARGV</code> 数组的 Perl6 等价物。</p>

<p>在 Perl 6 中，数组，数组元素和数组切片总是使用 <code>@</code> sigil，与 Perl 5 不同，其中各个数组元素使用 <code>$</code> sigil。同样，哈希和哈希元素现在总是带有 <code>%</code> sigil，无论是整个哈希，它的切片还是单个元素都在使用。</p>

<p>那里还有另一个符号，星号 &lsquo;twigil&rsquo;，<code>*</code>。这表明 <code>@*ARGS</code> 是一个动态特殊变量。</p>

<p><code>prompt</code> 和 <code>loop</code> 关键字是 Perl 6 中的新功能，两者都是令人钦佩的名字！</p>

<ul>
<li><code>prompt</code> 只返回用户输入的值，在本例中为变量。<br /></li>
<li><code>loop</code> 是 Perl 6 的新块控制关键字之一。像这样的简单循环块只是创建了一个无限循环，可以由程序员以显式的方式结束，例如在满足条件时使用 <code>last</code> 关键字;或者例如由用户手动终止程序。<br /></li>
<li>或者，循环可以采用三个参数，并且表现得像传统的C风格 <code>for</code> 循环。 （在 Perl 6 中，小精灵，<code>for</code> 只用于迭代列表或其他容器。）<br /></li>
</ul>

<p>在循环内部，小精灵，你可以看到范围对象。一切都是 Perl 6 中的一个对象，所以我可以在范围上调用 <code>pick</code> 方法来返回一个随机数。（好吧，无论如何，这是一个非加密安全的伪随机数！）</p>

<p><code>any</code> 关键字将 <code>@exits</code> 数组转换为 Perl 6 中许多新的有用数据结构之一：一个 <a href="https://perl6advent.wordpress.com/2009/12/13/">Junction</a>。这使得使用 smartmatch 运算符 <code>~~</code> 直截了当地找到一个数组元素。<code>last</code> 关键字退出循环，如 Perl 5 中所示。</p>

<p><a href="https://docs.perl6.org/type/Junction">Junction</a> 是一种新类型的容器或列表，允许进行许多最有用的比较，例如 <code>any</code>，<code>all</code>，<code>one</code> 或 <code>none</code>，我们在 Perl 5 中使用 <code>grep</code> 或 <code>List::Util</code> 等模块进行比较，但它使它们成为可能键入更容易，并允许它们同时执行！这样做的一个副作用是 junction 是无序的：但它们主要是为了产生单个真值或假值，所以通常都可以。如果你想快速想要根据一些特定值的简短列表检查一个值，那么 junction 就很棒。但是如果需要的话，它们还能够让你匹配更大的值集。</p>

<p>在最后一个代码段落的顶部，您将看到 <code>:exists</code> 应用于 <code>%score&lt;total&gt;</code> 哈希键。<code>:exists</code> 是一个 Perl 6 副词！副词通常会修改方法的工作方式。<code>:exists</code> 是下标副词。它是一个副词，因为它改变了读取哈希键时发生的事情：不是返回值，而是查明值是否存在。这通常是使用 Perl 5 类中关注的那些熟悉的已定义方法的更好的替代方法。</p>

<p>当然，<code>exists</code> 测试就是为了确保在用户第一次退出程序时不会出现错误。</p>

<p>为什么我使用锯齿形符号来引用哈希键？好吧，花括号 <code>{}</code> 是散列键的标准下标运算符，如 Perl 5. 但是，大多数情况下你可能想要使用尖括号/锯齿形符号，因为它们提供单字键的自动引用。用于在 Perl 5 中执行此操作的简单<code>{}</code> 括号，但在 Perl 6 中不再执行此操作。需要引起括号内的字符串。</p>

<p>在 Perl 6 中，放置了用于向终端输出文本的标准命令。这将输出以下列表项，然后是换行符。<code>say</code> 和 <code>print</code> 仍然可用; <code>say</code> 和 <code>put</code> 这两个都打印到标准输出并添加换行符; <code>print</code> 不会追加换行符。</p>

<p>如果你使用这个程序以及知道它是如何工作的，小精灵，你将有选择和知识，是否，何时以及如何在你自己的头脑中执行乘法，以及什么时候最好让 Perl 6 -有动力的电脑做它。您的圣诞节作业是让您自己熟悉<a href="https://docs.perl6.org/">https://docs.perl6.org</a> 上的 Perl 6 文档。“</p>

<p>小精灵开始使用乘法测试程序，试图超越对方以获得最高的完美分数。他们发现它如此令人上瘾，以至于比赛甚至会加时到在学校的最后一天，当时他们应该正在观看&rsquo;精灵&rsquo;！</p>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>ohmysummer ❤ Perl 6</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
