<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="ohmysummer">
    <meta name="description" content="ohmysummer&#39;s personal website">
    <meta name="keywords" content="Perl6,Rakudo">

    <base href="http://ohmysummer.github.io/">
    <title>
  Everyone Loves Porgs · 焉知非鱼
</title>

    <link rel="canonical" href="http://ohmysummer.github.io/post/2018-02-17-everyone-loves-porgs/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.cd087ace86754b082dec94545567f8361cba42e84f8e15edbc4a9f6e52bd1f6a.css" integrity="sha256-zQh6zoZ1Swgt7JRUVWf4Nhy6QuhPjhXtvEqfblK9H2o=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://ohmysummer.github.io/css/style.css">
    

    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ohmysummer.github.io/">
      焉知非鱼
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/post">博客</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/categories">归档</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/page/about/">关于</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags">标签</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Everyone Loves Porgs</h1>
    </header>

    <p>这个想法有一阵子了。我在完成的各个阶段都有几个发文的想法，有时候很难优先考虑这个问题。所以我想我要开始发布我一直在玩的更短的想法和事情，以免这个博客变成那些永不更新的博客之一。所以，我们开始吧。</p>

<p>类在 Perl 6 中很容易定义。它们非常容易，我发现自己使用它们来封装小型的 Hash-like 那样的东西，其中我也可能会使用一两种方法。</p>

<pre><code class="language-perl6">class Contact {
    has $.name;
    has $.phone;
    has $.bday;
    method age {
        (Date.new($.bday), *.later(:1year) ...^ * &gt; Date.today).end
    }
}
</code></pre>

<p>是的，这是一种低效率的计算年龄的方法&hellip;&hellip;就像生活中的很多事情一样，你越老，这种方法变得越慢。</p>

<p>无论如何，现在我已经定义了一个简单的小类来保存一些数据，但要实际实例化一个我不得不 bust out 一些命名参数。</p>

<pre><code class="language-perl6">my @contacts;
@contacts.push: Contact.new(:name&lt;John&gt;, :phone&lt;555-1111&gt;, :bday&lt;1940-10-09&gt;);
</code></pre>

<p>谁有时间为所有这些角色？有时候我只是想用位置参数来构建它们，但这意味着要编写一个新的自定义 <code>multi method new</code> 来处理这些情况&hellip;&hellip;但我只是将一个快速肮脏的类放在一起，真的值得我花时间来构建自定义构造函数吗？</p>

<p>于是我开始四处游玩，并创建了一个让我用 Positional 参数的角色&hellip;&hellip;或一个 Array ..或 List &hellip;构建我的类，嘿，I threw in a Hash for free!！</p>

<pre><code class="language-perl6">@contacts.push: Contact.new('James', '555-1112', '1942-06-18');

@contacts.push: Contact.new(&lt; George 555-1113 1943-02-25 &gt;)

my %hash = name =&gt; 'Richard', phone =&gt; '555-1114', bday =&gt; '1940-07-07';
@contacts.push: Contact.new(%hash);
</code></pre>

<p>我使用了自省方法 <code>.^attributes</code> 来获取属性列表。我只对本地属性感兴趣（不是继承的属性），尽管你肯定可以改变它，甚至通过参数化角色来控制它。我也只对拥有存取器的属性感兴趣（例如公共属性）。</p>

<pre><code class="language-perl6">role Porgs {
    multi method new(*@args where *.elems) {
        self.bless: |%(
            self.^attributes(:local)
                .grep(*.has_accessor)
                .map(*.name.substr: 2)
            Z=&gt; @args)
    }
    multi method new(List $args) {
        self.new: |$args
    }
    multi method new(%args) {
        self.bless: |%args
    }
}

class Contact does Porgs { ... }
</code></pre>

<p>我称 Porgs 为 &ldquo;Positional Args&rdquo; 的缩写，但也和来自 Star Wars(星球大战) 中的生物共享一个名字。 <code>Porgs</code> 角色允许你编写小而可爱的类，就像生物一样。此外，每个人都喜欢 Porgs。</p>

<p><img src="http://www.0racle.info/images/porgs.jpg" alt="img" /></p>

<p>这就是今天的全部。我不打算将此发布到生态系统或任何其他计划中，因此，如果您愿意，请随时加以改进，重新命名并将其发布到生态系统中。另外，我不确定 <code>self.^attributes</code> 是否按照您声明的顺序返回属性是一个实现细节&hellip;&hellip;所以也许这可能会变化？</p>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>ohmysummer ❤ Perl 6</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
