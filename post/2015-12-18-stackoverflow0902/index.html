<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="ohmysummer">
    <meta name="description" content="ohmysummer&#39;s personal website">
    <meta name="keywords" content="Perl6,Rakudo">

    <base href="http://ohmysummer.github.io/">
    <title>
  stackoverflow0902 · 焉知非鱼
</title>

    <link rel="canonical" href="http://ohmysummer.github.io/post/2015-12-18-stackoverflow0902/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.cd087ace86754b082dec94545567f8361cba42e84f8e15edbc4a9f6e52bd1f6a.css" integrity="sha256-zQh6zoZ1Swgt7JRUVWf4Nhy6QuhPjhXtvEqfblK9H2o=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://ohmysummer.github.io/css/style.css">
    

    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ohmysummer.github.io/">
      焉知非鱼
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/post">博客</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/categories">归档</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/page/about/">关于</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags">标签</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>stackoverflow0902</h1>
    </header>

    

<p><a href="http://stackoverflow.com/questions/37979519/how-do-i-chain-to-an-inline-block-in-perl-6">How do I chain to an inline block in Perl 6?</a></p>

<p>我想修改一个数组(我在这个例子中使用了 <code>splice</code>, 但是它也可能是修改数组的任何操作)并返回修改后的数组 - 和 <code>slice</code> 不一样, slice 返回的是从数组中抠出的项。我可以很容易地通过在数组中存储一个 block 来做到, 就像下面这样:</p>

<pre><code class="language-perl6">my $1 = -&gt; $a { splice($a,1,3,[1,2,3]); $a };
say (^6).map( { $_ &lt; 4 ?? 0 !! $_ } ).Array;
# [0 0 0 0 4 5]
say (^6).map( { $_ &lt; 4 ?? 0 !! $_ } ).Array.$1;
# [0 1 2 3 4 5]
</code></pre>

<p>我怎么把由 <code>$1</code> 代表的 block 内联到单个表达式中呢？ 下面的解决方法不正确:</p>

<pre><code class="language-perl6">say (^6).map( { $_ &lt; 4 ?? 0 !! $_ } ).Array.(-&gt; $a { splice($a,1,3,[1,2,3]); $a })
Invocant requires a type object of type Array, but an object instance was passed.  Did you forget a 'multi'?
</code></pre>

<p>解决方法是添加一个 <code>&amp;</code> 符号:</p>

<pre><code class="language-perl6">say (^6).map( { $_ &lt; 4 ?? 0 !! $_ } ).Array.&amp;(-&gt; $a { splice($a,1,3,[1,2,3]); $a })
# 输出 [0 1 2 3 4 5]
</code></pre>

<h2 id="getting-a-positional-slice-using-a-range-variable-as-a-subscript-http-stackoverflow-com-questions-38535690-getting-a-positional-slice-using-a-range-variable-as-a-subscript"><a href="http://stackoverflow.com/questions/38535690/getting-a-positional-slice-using-a-range-variable-as-a-subscript">Getting a positional slice using a Range variable as a subscript</a></h2>

<pre><code class="language-perl6">my @numbers = &lt;4 8 16 16 23 42&gt;;
.say for @numbers[0..2]; # this works
# 4
# 8
# 15

# but this doesn't
my $range = 0..2;
.say for @numbers[$range];
# 16
</code></pre>

<p>最后的那个下标看起来好像把 <code>$range</code> 解释为range中元素的个数(3)。怎么回事?</p>

<h2 id="解决方法">解决方法</h2>

<p>使用 <code>@numbers[|$range]</code> 把 range 对象展平到列表中。或者在 <strong>Range</strong> 对象上使用绑定来传递它们。</p>

<pre><code class="language-perl6"># On Fri Jul 2016, gfldex wrote:
my @numbers =  &lt;4 8 15 16 23 42&gt;; my $range = 0..2; .say for @numbers[$range];

# OUTPUT«16»
# expected:
# OUTPUT«4\n 8\n 15»


# 这是对的, 并且还跟 &quot;Scalar container implies item&quot; 规则有关.
# Changing it would break things like the second evaluation here:

my @x = 1..10; my @y := 1..3; @x[@y]
# (2 3 4)

@x[item @y]
# 4

# 注意在签名中 range 可以被绑定给 @y, 而特殊的 Range 可以生成一个像 @x[$(@arr-param)] 的表达式
# 这在它的语义中是不可预期的。

# 同样, 绑定给 $range 也能提供预期的结果
my @numbers =  &lt;4 8 15 16 23 42&gt;; my $range := 0..2; .say for @numbers[$range];
# OUTPUT«4␤8␤15␤»

# 这也是预期的结果, 因为使用绑定就没有标量容器来强制被当成一个 item 了。
# So, all here is working as designed.
</code></pre>

<p>或者：</p>

<pre><code class="language-perl6">.say for @numbers[@($range)]
# 4
# 8
# 15
</code></pre>

<p>绑定到标量容器的符号输出一个东西
可以达到你想要的选择包含：</p>

<p>前置一个 @ 符号来得到单个东西的复数形式：numbers[@$range]; 或者以不同的形式来声明 ragne 变量, 以使它直接工作。
对于后者, 考虑下面的形式:</p>

<pre><code class="language-perl6"># Bind the symbol `numbers` to the value 1..10:
my \numbers = [0,1,2,3,4,5,6,7,8,9,10];

# Bind the symbol `rangeA` to the value 1..10:
my \rangeA  := 1..10;
# Bind the symbol `rangeB` to the value 1..10:
my \rangeB   = 1..10;

# Bind the symbol `$rangeC` to the value 1..10:
my $rangeC  := 1..10;

# Bind the symbol `$rangeD` to a Scalar container
# and then store the value 1..10 in it:`
my $rangeD   = 1..10;

# Bind the symbol `@rangeE` to the value 1..10:
my @rangeE  := 1..10;

# Bind the symbol `@rangeF` to an Array container and then
# store 1 thru 10 in the Scalar containers 1 thru 10 inside the Array
my @rangeF   = 1..10;

say numbers[rangeA];  # (1 2 3 4 5 6 7 8 9 10)
say numbers[rangeB];  # (1 2 3 4 5 6 7 8 9 10)
say numbers[$rangeC]; # (1 2 3 4 5 6 7 8 9 10)
say numbers[$rangeD]; # 10
say numbers[@rangeE]; # (1 2 3 4 5 6 7 8 9 10)
say numbers[@rangeF]; # (1 2 3 4 5 6 7 8 9 10)
</code></pre>

<p>绑定到标量容器(<code>$rangeD</code>)上的符号总是产生单个值。在 <code>[...]</code>下标中单个值必须是数字。
对于 range, 被当作单个数字时, 产生的是 range 的长度。</p>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>ohmysummer ❤ Perl 6</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
