<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="ohmysummer">
    <meta name="description" content="ohmysummer&#39;s personal website">
    <meta name="keywords" content="Perl6,Rakudo">

    <base href="http://ohmysummer.github.io/">
    <title>
  Perl 6 中的 polymod 方法 · 焉知非鱼
</title>

    <link rel="canonical" href="http://ohmysummer.github.io/post/2015-09-17-perl6%E4%B8%AD%E7%9A%84polymod%E6%96%B9%E6%B3%95/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.cd087ace86754b082dec94545567f8361cba42e84f8e15edbc4a9f6e52bd1f6a.css" integrity="sha256-zQh6zoZ1Swgt7JRUVWf4Nhy6QuhPjhXtvEqfblK9H2o=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://ohmysummer.github.io/css/style.css">
    

    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://ohmysummer.github.io/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://ohmysummer.github.io/">
      焉知非鱼
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/post">博客</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/categories">归档</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/page/about/">关于</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags">标签</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Perl 6 中的 polymod 方法</h1>
    </header>

    

<blockquote>
<p>Perl 6 中的 .polymod 方法 - 把数字分解成分母</p>
</blockquote>

<h2 id="命名">命名</h2>

<p><code>.polymod</code> 方法接受几个除数并把它的调用者分解成一份一份的:</p>

<pre><code class="language-perl6">my $seconds = 1 * 60*60*24 # days
            + 3 * 60*60    # hours
            + 4 * 60       # minutes
            + 5;           # seconds

say $seconds.polymod: 60, 60;
say $seconds.polymod: 60, 60, 24;

# OUTPUT:
# (5 4 27)
# (5 4 3 1)
</code></pre>

<p>这种情况下我们作为参数传递的除数是和时间相关的: 60(每分钟有多少秒)， 60(每小时有多少分钟)，和24(每天有多少小时)。从最小的单位开始， 我们一直前进到最大的单位。</p>

<p>输出和输入的除数是相匹配的 - 从最小的单位到最大的单位： 5 秒，4 分钟，3 小时和 1 天。</p>

<h2 id="手工制作">手工制作</h2>

<p>不使用 <code>.polymod</code> 而使用一个循环来展示怎么之前的计算:</p>

<pre><code class="language-perl6">my $seconds = 2 * 60*60*24 # days
            + 3 * 60*60    # hours
            + 4 * 60       # minutes
            + 5;           # seconds

my @pieces;
for 60, 60, 24 -&gt; $divisor {
    @pieces.push: $seconds mod $divisor;
    $seconds div= $divisor
}
@pieces.push: $seconds;

say @pieces;

# OUTPUT:
# [5 4 3 2]
</code></pre>

<h2 id="超越无限">超越无限</h2>

<p>当除数是以惰性列表的形式传递给 <code>.polymod</code> 方法时，它会一直运行直到余数为零并不会遍历整个列表:</p>

<pre><code class="language-perl6">say 120.polymod:      10¹, 10², 10³, 10⁴, 10⁵;
say 120.polymod: lazy 10¹, 10², 10³, 10⁴, 10⁵;
say 120.polymod:      10¹, 10², 10³ … ∞;

# OUTPUT:
# (0 12 0 0 0 0)
# (0 12)
# (0 12)
</code></pre>

<p>在第一个调用中， 我们让一系列数字按 10 的幂增长。该调用的输出包含了 4 个尾部的零，因为 <code>.polymod</code> 方法计算了每个除数。在第二个调用中，我们使用 <code>lazy</code> 关键字显式地创建了一个惰性列表， 而现在我们在返回的列表中只有 2 个条目。</p>

<p>第一个除数(10)结果余数为 0，这是返回列表中的第一个条目，对于下一个除数，整除把我们的 120 变成了 12。12 除以 100 的余数为 12， 它是返回列表中的第二个条目。 现在， 12 整除 100 为 0， 它终止了 <code>.polymod</code> 的执行并给了我们两个 条目的结果。</p>

<p>在最后一个调用中，我们使用了省略号，它是一个序列操作符，用来创建一系列按 10 的幂增长的数字，但是这一次序列是无限的。因为它是惰性的，结果再一次只有 2 个元素。</p>

<h2 id="zip-it-lock-it-put-it-in-the-pocket">Zip It, Lock It, Put It In The Pocket</h2>

<p>单独的数字很好但是对于它们所代表的单位不够具有描述性。我们来使用 Zip 元操作符:</p>

<pre><code class="language-perl6">my @units  = &lt;ng μg mg g kg&gt;;
my @pieces = 42_666_555_444_333.polymod: 10³ xx ∞;

say @pieces Z~ @units;
# OUTPUT:
# (333ng 444μg 555mg 666g 42kg)
</code></pre>

<h2 id="快速命名">快速命名</h2>

<p>对于被调用者和除数，你不仅仅限于使用 Ints，也可以使用其它类型的数字。</p>

<pre><code class="language-perl6">say ⅔.polymod: ⅓;

say 5.Rat.polymod: .3, .2;
say 3.Rat.polymod: ⅔, ⅓;

# OUTPUT:
# (0 2)
# (0.2 0 80)
# (0.333333 0 12)
</code></pre>

<pre><code class="language-perl6">say 5.Num.polymod: .3, .2;
say 3.Num.polymod: ⅔, ⅓;

# OUTPUT:
# (0.2 0.199999999999999 79)
# (0.333333333333333 2.22044604925031e-16 12)
</code></pre>

<h2 id="使用-number-denominate-模块">使用 Number::Denominate 模块</h2>

<p><a href="http://modules.perl6.org/repo/Number::Denominate">Number::Denominate</a></p>

<pre><code class="language-perl6">use Number::Denominate;

my $seconds = 1 * 60*60*24 # days
            + 3 * 60*60    # hours
            + 4 * 60       # minutes
            + 5;           # seconds

say denominate $seconds;
say denominate $seconds, :set&lt;weight&gt;;

# OUTPUT:
# 1 day, 3 hours, 4 minutes, and 5 seconds
# 97 kilograms and 445 grams
</code></pre>

<p>你还可以定义自己的单位:</p>

<pre><code class="language-perl6">say denominate 449, :units( foo =&gt; 3, &lt;bar boors&gt; =&gt; 32, 'ber' );

# OUTPUT:
# 4 foos, 2 boors, and 1 ber
</code></pre>

<p><a href="http://perl6.party/post/Perl6-.polymod-break-up-a-number-into-denominations">原文地址</a></p>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>ohmysummer ❤ Perl 6</p>
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
