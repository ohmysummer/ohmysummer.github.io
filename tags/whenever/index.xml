<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Whenever on 焉知非鱼</title>
    <link>http://ohmysummer.github.io/tags/whenever/</link>
    <description>Recent content in Whenever on 焉知非鱼</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 23 Nov 2018 16:18:07 +0800</lastBuildDate>
    
	<atom:link href="http://ohmysummer.github.io/tags/whenever/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Send-Data-to-Socket</title>
      <link>http://ohmysummer.github.io/post/2018-11-23-send-data-to-socket/</link>
      <pubDate>Fri, 23 Nov 2018 16:18:07 +0800</pubDate>
      
      <guid>http://ohmysummer.github.io/post/2018-11-23-send-data-to-socket/</guid>
      <description>发送数据到 Socket 的 3333 端口，并把所发送的数据保存到文件中。
my $vin = &#39;LSJA0000000000091&#39;; my $last_meter = 0; react { whenever IO::Socket::Async.listen(&#39;0.0.0.0&#39;, 3333) -&amp;gt; $conn { my $fh = open &#39;events.txt&#39;, :w; react { my Bool:D $ignore = True; whenever Supply.interval(5).rotor(1, 1 =&amp;gt; 1) { $ignore = !$ignore; } whenever Supply.interval(1) { next if $ignore; $fh.print: sprintf(&amp;quot;\{&#39;vin&#39;:&#39;%s&#39;,&#39;createTime&#39;:%s,&#39;mileage&#39;:%s}\n&amp;quot;, $vin, DateTime.now.posix, $last_meter); $conn.print: sprintf(&amp;quot;\{&#39;vin&#39;:&#39;%s&#39;,&#39;createTime&#39;:%s,&#39;mileage&#39;:%s}\n&amp;quot;, $vin, DateTime.now.posix, $last_meter++); } whenever signal(SIGINT) { say &amp;quot;Done.&amp;quot;; $fh.close; done; } } } CATCH { default { say .</description>
    </item>
    
  </channel>
</rss>